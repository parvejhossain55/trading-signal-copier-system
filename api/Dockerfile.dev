# Development stage with Air for hot-reload
FROM golang:1.24-alpine3.20

WORKDIR /app

# Allow Go to auto-download the required toolchain version if needed
ENV GOTOOLCHAIN=auto

# Install build dependencies and Air
RUN apk add --no-cache git && \
    go install github.com/air-verse/air@latest

# Copy dependency files and download modules
COPY go.mod go.sum ./
RUN go mod download

# Source code will be mounted as a volume at runtime
# Air will watch for changes and rebuild automatically

EXPOSE 9090

CMD ["air", "-c", ".air.toml"]
